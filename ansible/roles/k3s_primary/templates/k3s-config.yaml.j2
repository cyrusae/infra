# /etc/rancher/k3s/config.yaml
# Generated by Ansible -- do not edit by hand.
#
# SYNTAX RULES (learned the hard way -- see KB - TLS and Certificates):
#   - Keys must be kebab-case (tls-san, node-ip) NOT snake_case or camelCase
#   - String values must be quoted
#   - K3s silently ignores unrecognised keys with no error -- verify after restart

cluster-init: true
node-ip: "{{ node_ip }}"

tls-san:
  - "{{ node_ip }}"
  - "{{ tailscale_hostname }}"

# Disable built-in Traefik -- Terraform manages it instead (terraform/traefik/).
# Must be present before K3s first starts. Two Traefik instances competing for
# ports 80/443 was a direct contributor to the pre-rebuild phantom port failure.
# See ARCHIVE - Ghost Hunt and Rebuild Decision.
disable:
  - traefik
